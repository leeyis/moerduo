# 磨耳朵 - 开源免费跨平台定时音频播放软件

## 项目概述

这是一个基于Tauri框架开发的跨平台桌面应用程序，提供灵活的定时音频播放功能。通过定时播放用户自定义的音频内容，适用于多种场景：
- **个人闹钟**：设置定时播放音乐、语音提醒等
- **语言学习**：家长为孩子设置定时播放外语音频来"磨耳朵"，帮助记忆和培养语感
- **知识学习**：定时播放课程、有声读物、学习材料等
- **习惯养成**：通过定时音频提醒帮助建立良好的作息习惯

## 技术栈

### 前端
- **React 18** - UI框架
- **TypeScript** - 类型安全
- **Tailwind CSS** - 样式方案
- **Lucide React** - 图标库
- **Zustand** - 状态管理
- **Vite** - 构建工具

### 后端
- **Tauri 1.5** - 桌面应用框架
- **Rust** - 后端语言
- **SQLite** - 本地数据库 (rusqlite)
- **Rodio** - 音频播放引擎
- **Tokio** - 异步运行时
- **Chrono** - 时间处理

## 已完成功能

### ✅ 核心功能模块

#### 1. 音频文件管理
- [x] 音频文件上传（支持MP3、WAV、OGG、FLAC、M4A格式）
- [x] 文件列表展示（文件名、大小、时长、格式、上传日期）
- [x] 文件搜索功能
- [x] 单个/批量删除
- [x] 在线测试播放
- [x] 文件大小和时长显示

#### 2. 播放列表管理
- [x] 创建多个播放列表
- [x] 播放模式切换（顺序播放/随机播放/单曲循环/列表循环）
- [x] 向播放列表添加音频
- [x] 从播放列表移除音频
- [x] 播放列表删除
- [x] 列表内容展示

#### 3. 定时任务系统
- [x] 创建定时播放任务
- [x] 设置触发时间（时:分）
- [x] 重复模式设置：
  - 每天
  - 工作日（周一至周五）
  - 周末（周六、周日）
  - 自定义星期选择
  - 仅一次
- [x] 关联播放列表
- [x] 音量控制（0-100%）
- [x] 渐强时长设置（0-300秒）
- [x] 任务启用/禁用切换
- [x] 任务编辑和删除
- [x] 任务列表展示

#### 4. 音频播放引擎
- [x] 基于Rodio的音频播放
- [x] 播放/暂停/停止控制
- [x] 音量控制
- [x] 播放状态管理
- [x] 多格式支持

### ✅ 基础架构
- [x] Tauri项目初始化
- [x] React + TypeScript前端架构
- [x] 路由系统配置
- [x] SQLite数据库设计和初始化
- [x] Rust后端模块化架构
- [x] 前后端通信机制

### ✅ 用户界面
- [x] 响应式侧边栏导航
- [x] 音频库管理页面
- [x] 播放列表管理页面
- [x] 定时任务管理页面
- [x] 统计页面（占位）
- [x] 设置页面（占位）
- [x] 帮助页面
- [x] 现代化UI设计（Tailwind CSS）

## 待完成功能

### 🔄 进行中
- [ ] 项目编译和基础功能测试

### 📋 计划实现
- [ ] 定时任务调度引擎（自动触发）
- [ ] 全局播放控制器组件
- [ ] 闹钟提醒窗口
- [ ] 系统托盘功能
- [ ] 统计功能（播放次数、时长统计）
- [ ] 设置功能（开机自启动、主题切换、数据备份）
- [ ] 播放速度调节
- [ ] 音频时长自动检测（当前使用默认值）
- [ ] 完整的集成测试
- [ ] 性能优化
- [ ] 打包和构建配置

## 项目结构

```
moerduo/
├── src/                      # 前端源代码
│   ├── pages/               # 页面组件
│   │   ├── AudioLibrary.tsx # 音频库
│   │   ├── Playlists.tsx    # 播放列表
│   │   ├── Tasks.tsx        # 定时任务
│   │   ├── Statistics.tsx   # 统计
│   │   ├── Settings.tsx     # 设置
│   │   └── Help.tsx         # 帮助
│   ├── App.tsx              # 主应用组件
│   ├── main.tsx             # 入口文件
│   └── index.css            # 全局样式
├── src-tauri/               # 后端源代码
│   └── src/
│       ├── main.rs          # 主程序入口
│       ├── db.rs            # 数据库初始化
│       ├── audio.rs         # 音频文件管理
│       ├── player.rs        # 音频播放引擎
│       ├── playlist.rs      # 播放列表管理
│       ├── task.rs          # 定时任务管理
│       └── scheduler.rs     # 任务调度器（待实现）
├── package.json             # 前端依赖
├── Cargo.toml               # 后端依赖
└── README.md                # 本文件
```

## 数据库设计

### 核心数据表

1. **audio_files** - 音频文件表
   - 存储上传的音频文件信息
   - 记录播放次数和最后播放时间

2. **playlists** - 播放列表表
   - 管理多个播放列表
   - 支持不同播放模式

3. **playlist_items** - 播放列表项表
   - 关联音频和播放列表
   - 支持自定义排序

4. **scheduled_tasks** - 定时任务表
   - 存储所有定时播放任务
   - 支持灵活的重复模式

5. **execution_history** - 执行历史表
   - 记录任务执行记录
   - 用于统计分析

6. **app_settings** - 应用设置表
   - 存储应用配置项

## 开发进度

### 第一阶段：基础框架 ✅ (100%)
- ✅ Tauri项目初始化
- ✅ 前端React框架搭建
- ✅ 数据库设计与实现
- ✅ 基础UI布局

### 第二阶段：核心功能 ✅ (100%)
- ✅ 音频文件管理模块
- ✅ 音频播放引擎
- ✅ 播放列表管理
- ✅ 测试播放功能

### 第三阶段：定时任务 🔄 (60%)
- ✅ 任务管理界面
- ✅ 任务CRUD操作
- ⏳ 任务调度引擎
- ⏳ 闹钟提醒窗口
- ⏳ 系统唤醒功能

### 第四阶段：完善功能 ⏳ (0%)
- ⏳ 统计功能
- ⏳ 设置模块
- ⏳ 帮助文档
- ⏳ 首次使用引导

### 第五阶段：测试优化 ⏳ (0%)
- ⏳ 功能测试
- ⏳ 性能优化
- ⏳ Bug修复
- ⏳ 跨平台测试

### 第六阶段：发布准备 ⏳ (0%)
- ⏳ 打包配置
- ⏳ 安装程序制作
- ⏳ 文档完善
- ⏳ 发布

## 如何运行

### 前置要求
- Node.js 18+
- npm 10+
- Rust 1.70+
- Cargo

### 安装依赖

```bash
# 进入项目目录
cd moerduo

# 安装npm依赖
npm install

# Cargo依赖会自动下载
```

### 开发模式运行

```bash
npm run tauri dev
```

### 构建生产版本

```bash
npm run tauri build
```

## 测试计划

### 功能测试
1. **音频管理测试**
   - [ ] 上传不同格式音频文件
   - [ ] 删除单个和多个文件
   - [ ] 搜索功能测试
   - [ ] 测试播放功能

2. **播放列表测试**
   - [ ] 创建和删除列表
   - [ ] 添加和移除音频
   - [ ] 切换播放模式
   - [ ] 播放列表播放

3. **定时任务测试**
   - [ ] 创建各种重复模式的任务
   - [ ] 编辑和删除任务
   - [ ] 启用/禁用切换
   - [ ] 定时触发测试

### 性能测试
- [ ] 大量音频文件加载测试（200+文件）
- [ ] 内存占用监控
- [ ] CPU使用率测试
- [ ] 长时间运行稳定性测试

## 当前项目状态

**整体进度:** 约 60% 完成

**核心功能完成度:**
- 音频文件管理: 100%
- 播放列表管理: 100%
- 定时任务界面: 100%
- 定时任务调度: 30%
- 音频播放: 90%
- 统计功能: 10%
- 设置功能: 10%
- 系统集成: 20%

**下一步工作:**
1. 完成Rust代码编译测试
2. 实现定时任务调度引擎
3. 完善音频播放控制
4. 实现系统托盘和提醒窗口
5. 完成统计和设置功能
6. 全面测试和优化

## 许可证

待定

## 联系方式

项目负责人：开发团队

---
**最后更新:** 2025年10月14日
**文档版本:** v0.1.0
